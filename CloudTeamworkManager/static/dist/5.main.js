(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{18:function(t,a,i){var e,s;
/*!
 * classie - class helper functions
 * from bonzo https://github.com/ded/bonzo
 * 
 * classie.has( elem, 'my-class' ) -> true/false
 * classie.add( elem, 'my-new-class' )
 * classie.remove( elem, 'my-unwanted-class' )
 * classie.toggle( elem, 'my-class' )
 */!function(n){"use strict";function o(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")}var l,r,c;function d(t,a){(l(t,a)?c:r)(t,a)}"classList"in document.documentElement?(l=function(t,a){return t.classList.contains(a)},r=function(t,a){t.classList.add(a)},c=function(t,a){t.classList.remove(a)}):(l=function(t,a){return o(a).test(t.className)},r=function(t,a){l(t,a)||(t.className=t.className+" "+a)},c=function(t,a){t.className=t.className.replace(o(a)," ")}),void 0===(s="function"==typeof(e={hasClass:l,addClass:r,removeClass:c,toggleClass:d,has:l,add:r,remove:c,toggle:d})?e.call(a,i,a,t):e)||(t.exports=s)}(window)},20:function(t,a,i){var e=i(35);"string"==typeof e&&(e=[[t.i,e,""]]);var s={insert:"head",singleton:!1};i(3)(e,s);e.locals&&(t.exports=e.locals)},34:function(t,a,i){"use strict";var e=i(20);i.n(e).a},35:function(t,a,i){(t.exports=i(2)(!1)).push([t.i,"\n.navbar[data-v-1d1d7504] {\n    width: 100%;\n}\n.toast[data-v-1d1d7504]{\n    padding: 0px;\n}\n",""])},67:function(t,a,i){"use strict";i.r(a);var e=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",[i("div",{attrs:{id:"bar"}},[i("nav",{staticClass:"navbar navbar-expand-sm navbar-light bg-light",staticStyle:{height:"4rem","z-index":"1"}},[i("div",{staticClass:"container"},[i("a",{staticClass:"navbar-brand col-3",attrs:{href:"/"},on:{click:function(a){return a.preventDefault(),t.mySwitch(["home",null])}}},[i("img",{staticClass:"rounded",attrs:{src:"/static/pic/logo2.png"}})]),t._v(" "),i("div",{staticClass:"collapse navbar-collapse container",attrs:{id:"navbarNav"}},[i("ul",{staticClass:"navbar-nav col-8 container-fluid row"},[i("li",{staticClass:"nav-item col-4"},[i("a",{staticClass:"nav-link",attrs:{href:"/space/"},on:{click:function(a){return a.preventDefault(),t.mySwitch(["space",null])}}},[t._v("个人中心")])]),t._v(" "),i("li",{staticClass:"nav-item col-4"},[i("a",{staticClass:"nav-link",attrs:{href:"/task_list/"},on:{click:function(a){return a.preventDefault(),t.mySwitch(["taskList",null])}}},[t._v("任务列表")])]),t._v(" "),i("li",{staticClass:"nav-item col-4"},[i("a",{staticClass:"nav-link",attrs:{href:"/noti/"},on:{click:function(a){return a.preventDefault(),t.mySwitch(["noti",null])}}},[t._v("消息中心")])])]),t._v(" "),i("div",{staticClass:"collapse navbar-collapse justify-content-end",attrs:{id:"navbarNav-1"}},[i("ul",{staticClass:"navbar-nav col-auto"},[i("li",{staticClass:"nav-item "},[i("a",{staticStyle:{cursor:"pointer"},on:{click:function(a){return t.show_side_bar()}}},[i("img",{attrs:{src:"/static/pic/menu.png"}})])])])])])])]),t._v(" "),i("div",{staticClass:"modal fade",attrs:{id:"sidebar"}},[i("div",{staticClass:"modal-dialog",staticStyle:{margin:"0px",position:"absolute",right:"0rem",height:"100%",width:"20rem"}},[i("div",{staticClass:"modal-content",staticStyle:{"border-radius":"0px",border:"0px",height:"100%","background-color":"rgba(255, 255, 255, 0.7)"}},[i("div",{staticClass:"modal-body",staticStyle:{padding:"0px"}},[t.globle_props.is_login?t._e():i("div",[i("div",{staticStyle:{position:"absolute",top:"30%",left:"50%",transform:"translateX(-50%)"}},[i("img",{staticStyle:{position:"relative",left:"50%",transform:"translateX(-50%)"},attrs:{src:"/static/pic/user.png"}}),t._v(" "),i("div",{staticClass:"lead",staticStyle:{color:"#333333","margin-top":".5rem"}},[t._v("您还未"),i("a",{attrs:{href:"/account/login"},on:{click:function(a){return a.preventDefault(),t.hideBarAndSwitch(["signIn",null])}}},[t._v("登录")])])])]),t._v(" "),t.globle_props.is_login?i("div",[i("div",{staticClass:"clearfix",staticStyle:{width:"80%",height:"7.5rem","margin-left":"10%","margin-top":"5%"}},[i("div",{staticStyle:{float:"left",transform:"translateY(-50%)","text-align":"center",top:"50%",position:"relative"}},[i("div",{staticStyle:{color:"#333333","font-size":"26px"}},[t._v(t._s(t.globle_props.name))]),t._v(" "),i("a",{staticStyle:{color:"#F44336","font-size":"18px"},attrs:{href:"/account/logout/"},on:{click:function(a){return a.preventDefault(),t.logout(a)}}},[t._v("退出登录")])]),t._v(" "),i("img",{staticClass:"float-right rounded-circle",staticStyle:{width:"30%",top:"50%",transform:"translateY(-50%)",position:"relative"},attrs:{src:!!t.globle_props.is_login&&"/file/avatar/"}})]),t._v(" "),i("div",{staticStyle:{width:"100%","margin-top":"5%"}},[0==Number(t.globle_props.unread_notifications)?i("div",{staticStyle:{"padding-left":".75rem","font-weight":"bold"}},[t._v("暂无未读消息")]):t._e(),t._v(" "),t._l(t.globle_props.unread_notifications,(function(a,e){return i("div",{key:e,staticClass:"toast fade md-trigger",staticStyle:{"box-shadow":"0px 0px 0px",border:"0px","border-radius":"0px"},attrs:{"data-modal":"modal-4","data-autohide":"false",role:"console.log","aria-live":"assertive","aria-atomic":"true"},on:{click:function(i){return t.show_detail(a.verb,a.description,a.timestamp,a.id,e)}}},[i("div",{staticClass:"toast-header",staticStyle:{"border-bottom":"0px"}},[i("strong",{staticClass:"mr-auto"},[t._v(t._s(a.verb))]),t._v(" "),i("small",{staticClass:"text-muted"},[t._v(t._s(a.timestamp))]),t._v(" "),t._m(0,!0)]),t._v(" "),i("div",{staticClass:"toast-body"},[t._v(t._s(a.description))])])}))],2),t._v(" "),i("div",{staticStyle:{position:"fixed",bottom:"1rem",width:"100%","text-align":"center"}},[0!=Number(t.globle_props.unread_notifications)?i("a",{staticStyle:{"font-size":"12px",float:"right","text-decoration":"none","margin-right":"1rem"},attrs:{href:""},on:{click:function(a){return a.preventDefault(),t.mark_all_read()}}},[t._v("标记全部为已读")]):t._e(),t._v(" "),i("a",{staticStyle:{color:"#666666","font-size":"18px",display:"block",clear:"both","text-decoration":"none"},attrs:{href:"/noti/"},on:{click:function(a){return a.preventDefault(),t.hideBarAndSwitch(["noti",null])}}},[t._v("进入消息中心")])])]):t._e()])])])]),t._v(" "),i("div",[i("div",{staticClass:"md-modal md-effect-8",attrs:{id:"modal-4"}},[i("div",{staticClass:"md-content"},[i("div",[i("div",{staticClass:"container-fluid"},[t._m(1),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-12"},[i("div",{staticClass:"lead",staticStyle:{"letter-spacing":"2px"}},[t._v(t._s(t.detail_title))]),t._v(" "),i("div",{staticClass:"text-left",staticStyle:{"letter-spacing":"1px"}},[t._v("\n                                        "+t._s(t.detail_body)+"\n                                    ")])])]),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-12"},[i("small",[t._v(t._s(t.detail_date))])])])])])])]),t._v(" "),i("div",{staticClass:"md-overlay"})])])])};e._withStripped=!0;var s=i(18),n=i.n(s),o={data:()=>({name:"",comName:"",detail_title:"",detail_body:"",detail_date:""}),props:["globle_props"],mounted(){this.receive_noti(),this.modalEffects()},methods:{modalEffects:function(){var t=document.querySelector(".md-overlay");[].slice.call(document.querySelectorAll(".md-trigger")).forEach((function(a,i){var e=document.querySelector("#"+a.getAttribute("data-modal")),s=e.querySelector(".md-close");function o(){var t;t=n.a.has(a,"md-setperspective"),n.a.remove(e,"md-show"),t&&n.a.remove(document.documentElement,"md-perspective")}a.addEventListener("click",(function(i){n.a.add(e,"md-show"),t.removeEventListener("click",o),t.addEventListener("click",o),n.a.has(a,"md-setperspective")&&setTimeout((function(){n.a.add(document.documentElement,"md-perspective")}),25)})),s.addEventListener("click",(function(t){t.stopPropagation(),o()}))}))},logout:function(){this.$http.get("/account/logout/"),this.hideBarAndSwitch(["signIn",null])},hideBarAndSwitch:function(t){$("#sidebar").modal("hide"),this.mySwitch(t)},show_side_bar:function(){$("#sidebar").modal("toggle"),$(".toast").toast("show")},mark_all_read:function(){for(var t=$(".toast"),a=t.length-1,i=0;a>=0;a--,i++)this.doSetTimeout(t.eq(1*a),i);setTimeout(()=>{$("#sidebar").modal("toggle")},150*i),this.$http.get("/noti/mark_all_as_read/")},doSetTimeout:function(t,a){setTimeout(()=>{t.toast("hide")},150*a)},mySwitch:function(t){"signUp"==t[0]||this.globle_props.is_login?this.$emit("switch",t):this.$emit("switch",["signIn",null])},show_detail:function(t,a,i,e,s){this.detail_title=t,this.detail_body=a,this.detail_date=i,this.$http.get("/noti/mark_target_as_read/"+e),this.globle_props.read_notifications.unshift(this.globle_props.unread_notifications.splice(s,1)[0])},receive_noti:function(){var t=this;if("WebSocket"in window){console.log("您的浏览器支持 WebSocket!");var a=new WebSocket("ws://"+window.location.host+"/noti/receive_noti/");a.onopen=function(){console.log("与服务器连接成功!")},a.onmessage=function(a){var i=JSON.parse(a.data);200==i.status&&t.globle_props.unread_notifications.push(i)},a.onclose=function(){console.log("连接已断开")},window.s=a}else console.log("您的浏览器不支持 WebSocket!")}}},l=(i(34),i(5)),r=Object(l.a)(o,e,[function(){var t=this.$createElement,a=this._self._c||t;return a("button",{staticClass:"ml-2 close",attrs:{type:"button","data-dismiss":"toast","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"row justify-content-between"},[a("div",{staticClass:"col-4",staticStyle:{"margin-top":"10px","font-size":"24px"}},[this._v("\n                                    消息详情\n                                ")]),this._v(" "),a("div",{staticClass:"col-2",staticStyle:{"margin-top":"10px"}},[a("button",{staticClass:"md-close btn-sm btn-primary",staticStyle:{"background-color":"transparent",border:"none",height:"100%"}},[a("img",{attrs:{src:"/static/pic/close.png"}})])])])}],!1,null,"1d1d7504",null);r.options.__file="src/VueComponent/totalBar.vue";a.default=r.exports}}]);